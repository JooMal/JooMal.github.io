---
layout: post
title: "ì¸í”„ëŸ° - ì‹¤ì „ JSP 6"
date: 2021-01-05
tags: [jsp, backend]
category : [study]
comments: true
---

# ğ—ğ—¦ğ—£

- [ìˆ˜ê°• ì½”ìŠ¤](https://www.inflearn.com/course/%EC%8B%A4%EC%A0%84-jsp_renew/lecture/13652)

# ğ““ğ“ªğ”‚ 6

### 18. JDBC
JAVAì™€ ì˜¤ë¼í´ì´ í†µì‹ í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” APIì´ë‹¤. eclipseì—ì„œë„ ì˜¤ë¼í´ APIë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ì„œ, Oracle LIBì„ ì´í´ë¦½ìŠ¤ì— ë³µì‚¬í•˜ì—¬ ì‚¬ìš©í•œë‹¤.  

### 18.1. JDBC ì„¤ì •
1) ì´í´ë¦½ìŠ¤ Preferences - class pathì—ì„œ jre pathë¥¼ í™•ì¸í•œë‹¤.  
2) `C:\oraclexe\app\oracle\product\11.2.0\server\jdbc\lib`ì— ìˆëŠ” `ojbc6.jar` íŒŒì¼ì„ ë³µì‚¬í•´ì„œ ìœ„ì˜ jre lib ext pathì— ë„£ëŠ”ë‹¤.  

### 18.2. JDBCë¥¼ ì´ìš©í•œ ë°ì´í„° ê´€ë¦¬
#### ì „ì²´ì ì¸ íë¦„
client <-> jsp,servlet <-> DB  
í´ë¼ì´ì–¸íŠ¸ê°€ jsp, servletì— ìš”ì²­ì„ í•˜ë©´, ì›¹ì„œë²„ëŠ” JDBCë¥¼ ì´ìš©í•˜ì—¬ DBì— ì ‘ê·¼í•œë‹¤.  
#### JDBC ì‹¤í–‰ ìˆœì„œ
1) Driver loading : `class.forName(driver);`ë¼ê³  ë“œë¼ì´ë²„ ì´ë¦„ì„ ëª…ì‹œí•´ì£¼ì–´ì„œ, Oracle Driverë¥¼ ë©”ëª¨ë¦¬ì— ë¡œë”©í•˜ì—¬ ì–¸ì œë“ ì§€ ì“¸ ìˆ˜ ìˆê²Œ ëœë‹¤.  
2) Connection : ìë°”ì™€ ì˜¤ë¼í´ì„ ì—°ê²°í•´ì£¼ê¸° ìœ„í•´, ì—°ê²°ì„ í•´ì£¼ëŠ” connection ê°ì²´ë¥¼ ì–»ëŠ”ë‹¤. `con = DriverManager.getConnection(url, id, pw);` ë¥¼ ì´ìš©í•˜ì—¬ ì»¤ë„¥ì…˜ ê°ì²´ë¥¼ ë°›ëŠ”ë‹¤.  
3) Statement : `stmt = con.createStatement();` ë¥¼ ì´ìš©í•˜ì—¬ ìë°”ì—ì„œë„ ì¿¼ë¦¬ë¬¸ì„ ë‚ ë¦´ ìˆ˜ ìˆëŠ” ê°ì²´ì¸ `statement`ë¥¼ ì»¤ë„¥ì…˜ìœ¼ë¡œë¶€í„° êµ¬í•œë‹¤.  
4) query : `String sql = "SELECT * FROM book";` ì´ëŸ° ì‹ìœ¼ë¡œ String type queryë¬¸ì„ ì‘ì„±í•´ì¤€ë‹¤.  
5) run : ì‘ì„±í•œ ì¿¼ë¦¬ë¬¸ì„ statme ê°ì²´ì— ë„£ì–´ì£¼ì–´ ì¿¼ë¦¬ë¥¼ ì „ì†¡í•œë‹¤. `res = stmt.executeQuery(sql);`  

```java
response.setContentType("text/html; charset=UTF-8");
PrintWriter out = response.getWriter();

String bookName = request.getParameter("book_name");
String bookLoc = request.getParameter("book_loc");

String driver = "oracle.jdbc.driver.OracleDriver";
String url = "jdbc:oracle:thin:@localhost:1521:xe";
String id = "scott";
String pw = "tiger";

Connection con = null;
Statement stmt = null;

try {
  Class.forName(driver);

  con = DriverManager.getConnection(url, id, pw);
  stmt = con.createStatement();
  String sql = "INSERT INTO book(book_id, book_name, book_loc)";
      sql += " VALUES (BOOK_SEQ.NEXTVAL, '" + bookName + "', '" + bookLoc + "')";

  // executeUpdate()ëŠ” ì¿¼ë¦¬ê°€ ì ìš©ëœ ê°¯ìˆ˜ë¥¼ ë°˜í™˜í•œë‹¤.
  // ì—ëŸ¬ê°€ ë°œìƒí•´ì„œ ì•„ë¬´ê²ƒë„ ì ìš©ì´ ì•ˆë˜ì—ˆë‹¤ë©´, 0ì„ returní•œë‹¤.
  int result = stmt.executeUpdate(sql);

  if(result == 1) {
    out.print("INSERT success!!");
  } else {
    out.print("INSERT fail!!");
  }

// ë°ì´í„°ë² ì´ìŠ¤ì™€ ê´€ë ¨ëœê±´ ë„¤íŠ¸ì›Œí¬ìƒì˜ ë¬¸ì œ ë“±ì´
// ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê¼­ try-catch ë¬¸ìœ¼ë¡œ ë¬¶ì–´ì£¼ì–´ì•¼ í•œë‹¤.
} catch (Exception e) {
  e.printStackTrace();
} finally {
  try {
    //ë¦¬ì†ŒìŠ¤ë¥¼ ì¼ìœ¼ë©´ í•´ì œí•´ì£¼ëŠ” ì‘ì—…ë„ í•´ì£¼ì–´ì•¼ í•œë‹¤. ì´ì— stmtê°€ nullì´ë©´ ë¦¬ì†ŒìŠ¤ë¥¼ closeí•´ì£¼ëŠ” ì‘ì—…ì„ í•´ì£¼ê³  ìˆë‹¤.
    if(stmt != null) stmt.close();
    if(con != null) con.close();
  } catch (Exception e2) {
    e2.printStackTrace();
  }
}
}
```

### 18.3. PreparedStatement
statementì—ì„œ ì¿¼ë¦¬ë¬¸ì„ ì¡°ì‘í•  ë•Œ, ì½”ë“œê°€ ì§€ì €ë¶„í•œ ê°ì´ ìˆë‹¤. ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ 
