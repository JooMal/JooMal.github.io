---
layout: post
title: "ResultSet : SELECTì˜ ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´"
date: 2021-01-05
tags: [jdbc, backend]
category : [study]
comments: true
---

# ğ‘ğğ¬ğ®ğ¥ğ­ğ’ğğ­

ResultSetì€ SELECTë¬¸ì˜ ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´ì…ë‹ˆë‹¤.  
ìë°”ì—ì„œ DriverManagerë¡œë¶€í„° connection ê°ì²´ë¥¼ ë°›ì•„ì™€ jdbcì™€ì˜ ì—°ê²°ì„ ë§Œë“  í›„, SELECT ì¿¼ë¦¬ë¥¼ ëŒë¦°ë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤.  

```java
String driver = "oracle.jdbc.driver.OracleDriver";
String url = "...";
String id = "...";
String pw = "...";

Connection con = null;
Statement stmt = null;
ResultSet res = null;

/*
DBëŠ” ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì˜ ë¬¸ì œ ë“±ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì— **ë°˜ë“œì‹œ** try-catch ë¬¸ìœ¼ë¡œ ì—ëŸ¬ë¥¼ ì¡ì•„ StackTraceë¥¼ í†µí•´ ì¶”í›„ Exceptionì´ ë°œìƒí•œ ìœ„ì¹˜ë¥¼ ì •í™•íˆ ì•Œ ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.
*/
try {
  Class.forName(driver);

  con = DriverManager.getConnection(url, id, pw);
  stmt = con.createStatement();
  String sql = "SELECT * FROM book";

  // ì—¬ê¸° ResultSet ê°ì²´ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤!!!!!!!!!
  res = stmt.executeQuery(sql);

  // ResultSet ê°ì²´ë¥¼ ì´ìš©í•´, SELECTë¬¸ì˜ ê²°ê³¼ë¥¼ ìˆœíšŒí•˜ì—¬ ì›í•˜ëŠ” ê°’ë§Œ ë½‘ì•„ì˜¤ê±°ë‚˜ ì¶œë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  while(res.next()) {
    int bookId = res.getInt("book_id");
    String bookName = res.getString("book_name");
    String bookLoc = rest.getString("book_loc");

    out.print("bookId : " + bookId + ", ");
    out.print("bookName : " + bookName + ", ");
    out.print("bookLoc : " + bookLoc + "</br>");
  }
} catch (Exception e) {
  e.printStackTrace();
} finally {
  try {
    /*
    ResultSet, Statement, Connectionì´ nullì´ ì•„ë‹ˆë¼ë©´, ì¦‰ ì–´ë– í•œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” ë“± í”„ë¡œê·¸ë¨ì— ì˜í•˜ì—¬ ì‚¬ìš©ë˜ì—ˆë‹¤ë©´, ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ë¥¼ ìœ„í•´ ë°˜ë“œì‹œ ì¢…ë£Œí—¤ì¤ë‹ˆë‹¤.
    */
    if(res != null) res.close();
    if(stmt != null) stmt.close();
    if(con != null) con.close();
  } catch (Exception e2) {
    e2.printStackTrace();
  }
}
```

ìœ„ì˜ ì½”ë“œì—ì„œ ì‚¬ìš©ë˜ì—ˆë“¯, ResultSetì€ SELECTì˜ ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´ì…ë‹ˆë‹¤. ì´ë•Œ `Cursor`ëŠ” ResultSetì´ ê²°ê³¼ê°’ìœ¼ë¡œì„œ ë°›ì•„ì˜¨ SQL í…Œì´ë¸”ì„ ê° í–‰ì„ ê°€ë¦¬í‚µë‹ˆë‹¤. ë§ˆì¹˜ ìë°”ì˜ ìë£Œêµ¬ì¡°ë¥¼ ìˆœíšŒí•  ë•Œ ì“°ëŠ” iteratorì²˜ëŸ¼, `Cursor`ëŠ” í…Œì´ë¸” ê° í–‰ì„ ì´ë™í•˜ë©° ê·¸ ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆê²Œë” í•´ì¤ë‹ˆë‹¤.  

`Cursor`ëŠ” ì²˜ìŒì— **Before the first row**ë¥¼ ê°€ë¦¬í‚¤ê³  ìˆìŠµë‹ˆë‹¤. ë§ˆì¹˜ iteratorë¥¼ ì²˜ìŒ ë°›ì•„ì™”ì„ ë•Œì—, ì²« ë²ˆì§¸ ë…¸ë“œê°€ ì•„ë‹Œ **ê·¸ ì•ì˜ ë¬´ì–¸ê°€**ë¥¼ ê°€ë¦¬í‚¤ê³  ìˆëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤. iteratorì˜ ì“°ì„ìƒˆë¥¼ ë‹¤ì‹œ ë³µê¸°í•´ë³´ê² ìŠµë‹ˆë‹¤.  

#### Java Iterator

```java
List<String> list = Arrays.asList("A", "B", "C");
Iterator<String> iterator = list.iterator();
while(iterator.hasNext()) {
  String name = iterator.next();
  System.out.println(name);
}
```

#### ResultSet

```java
while(res.next()) {
  int bookId = res.getInt("book_id");
  String bookName = res.getString("book_name");
  String bookLoc = rest.getString("book_loc");

  out.print("bookId : " + bookId + ", ");
  out.print("bookName : " + bookName + ", ");
  out.print("bookLoc : " + bookLoc + "</br>");
}
```

ìœ„ì˜ ì½”ë“œì²˜ëŸ¼ **ë…¸ë“œê°€ ìˆê¸´ í•œê±´ì§€ ë¨¼ì € í™•ì¸í•˜ê³ **(hasNext()) ìš”ì†Œë¥¼ ë°›ì•„ì˜¤ê¸° ì‹œì‘í•©ë‹ˆë‹¤. ë§Œì•½ í™•ì¸í•˜ì§€ ì•Šê³  ë‹¤ì§œê³ ì§œ ê°€ì ¸ì™”ëŠ”ë°, ëŒ€ìƒì´ nullì´ë¼ë©´ NullPointerExceptionì´ ë°œìƒí•˜ê² ì£ ? ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì• ì´ˆë¶€í„° ì²« ë²ˆì§¸ ë…¸ë“œ ê·¸ ì´ì „ì˜ ì–´ë– í•œ ì‹œì‘ì ì„ ê°€ë¦¬í‚¤ê³  ìˆìŠµë‹ˆë‹¤.  

ì´ì œ ì´ëŸ¬í•œ `Cursor`ë¥¼ `next()` ë©”ì†Œë“œë¥¼ í™œìš©í•´ ê·¸ ê°’ì„ ê°€ì ¸ì˜¤ê²Œ ë©ë‹ˆë‹¤. `next()`ë©”ì†Œë“œëŠ” **ë”ì´ìƒ í–‰ì´ ì¡´ì¬í•˜ì§€ ì•Šì„ ë•Œ**ê¹Œì§€ trueë¥¼ ë¦¬í„´í•´ì£¼ê²Œ ë©ë‹ˆë‹¤.  
`res.getXXX()`ì„ ì´ìš©í•´ ì»¬ëŸ¼ë„ í•˜ë‚˜ì”© ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. `getXXX()`ì— íŒŒë¼ë¯¸í„°ë¡œ (1) ì»¬ëŸ¼ ìˆœì„œ, (2) ì»¬ëŸ¼ ì´ë¦„ì´ ë“¤ì–´ì˜¬ ìˆ˜ ìˆëŠ”ë°ìš”. ìœ„ì˜ ì˜ˆì œì˜ ê²½ìš° íŒŒë¼ë¯¸í„°ë¡œ (2) ì»¬ëŸ¼ ì´ë¦„ì´ ë“¤ì–´ì˜¨ ê²ƒì…ë‹ˆë‹¤.  

ë‚´ì¹œê¹€ì— (1) ì»¬ëŸ¼ ìˆœì„œë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ë¶€ë¶„ë„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ê°€ë ¹ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ bookNameê³¼ bookPriceë¥¼ ê°€ì ¸ì˜¨ë‹¤ë©´,

```java
while(res.next()) {
  String bookName = res.getString(1);
  String bookPrice = res.getInt(2);
}
```

ìœ„ì˜ ë°©ì‹ì´ ë˜ê² ë„¤ìš”.

---

# ğ‘¹ğ’†ğ’‡ğ’†ğ’“ğ’†ğ’ğ’„ğ’†
1. [stack traceê°€ ë¬´ì—‡ì¸ê°€ìš”?](https://hashcode.co.kr/questions/2162/stack-trace%EA%B0%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80%EC%9A%94-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%97%90%EB%9F%AC%EB%A5%BC-%EB%94%94%EB%B2%84%EA%B9%85%ED%95%A0-%EB%95%8C-%EA%B7%B8%EA%B2%83%EC%9D%84-%EC%96%B4%EB%96%BB%EA%B2%8C-%ED%99%9C%EC%9A%A9%ED%95%B4%EC%95%BC-%ED%95%98%EB%82%98%EC%9A%94)
2. [ResultSetì´ë€?](https://m.blog.naver.com/bluegriffin/40017575222)
