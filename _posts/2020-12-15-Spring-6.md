---
layout: post
title: "Spring Study - 6"
date: 2020-12-15
tags: [spring, backend]
category : [study]
comments: true
---

### 6. 스프링 DB 접근 기술

### 목차  
1. <a href="#1">H2 데이터베이스 설치</a>  
2. <a href="#2">순수 JDBC</a>
3. <a href="#3">스프링 통합 테스트</a>
4. <a href="#4">스프링 JdbcTemplate</a>
5. <a href="#5">JPA</a>
6. <a href="#6">스프링 데이터 JPA</a>


수강 코스는 <a href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EC%9E%85%EB%AC%B8-%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8/">인프런 스프링 입문 강의</a>를 듣고 있습니다.  

---

<a name="1"></a>
### H2 데이터베이스 설치
- 데이터 베이스 연결의 역사
  1. JDBC를 이용해 DB와 Spring을 연결
  2. 스프링이 이후 JDBC 템플릿으로 편리하게 연결해주는 방법을 도입
  3. 이후에는 SQL 조차도 직접 짜는게 아니라 조회쿼리 등을 날려주는 `JPA`라는 기술로 객체를 바로 DB에 쿼리없이 저장해주는 기술을 사용한다. 이를 스프링에서 편리하게 쓸 수 있도록 한 번 감싼 기술을 `스프링 데이터 JPA`라고 한다.
- H2는 메뉴얼을 따라 하면 된다.

```sql
drop table if exists member CASCADE;
create table member
(
 id bigint generated by default as identity,
 name varchar(255),
 primary key (id)
);
```

위의 코드를 H2에 입력하여 테이블 관리를 위한 `sql/ddl.sql`을 생성해준다.
id는 자바에서는 long이고 db에서는 bigint를 사용했고, generated by default as identity는 null로 들어오더라도 자동으로 값을 채워준다.

---

<a name="2"></a>
### 순수 JDBC
아주 예전 방식의 데이터저장기술로, 역사를 듣는다는 생각으로 키워드만 정리하면 된다고 하신다.

```sql
private final DataSource dataSource; //DB에 붙기 위한 데이터소스

public JdbcMemberRepository(DataSource dataSource) {
    this.dataSource = dataSource;
}

@Override
public Member save(Member member) {
    String sql = "insert into member(name) values(?)";
    Connection conn = dataSource.getConnection();
    PreparedStatement pstmt = conn.prepareStatement(sql);
    pstmt.setString(1, member.getName());
    //..어쩌구저쩌구..
    pstmt.executeUpdate();
    return null;
}
```

이런 식으로 진행되는데, 각 메소드를 다 지정해주어야하기 때문에 노가다 작업이다.
- 다형성을 이용해 빠르게 확장이 가능하다 => 개방-폐쇄 원칙 (OCP, Open-Closed Princople) : 확장에는 열려있고, 수정, 변경에는 닫혀있다. <= 객체지향의 장점 (구현제 변경 없이 쉽게 확장이 가능하다는 점)
---

<a name="3"></a>
### 스프링 통합 테스트


---

<a name="4"></a>

---

<a name="5"></a>

---

<a name="6"></a>

---
